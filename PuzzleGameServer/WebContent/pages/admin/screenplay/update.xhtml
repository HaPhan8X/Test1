<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.prime.com.tr/ui"
	xmlns:tvo="http://tinhvan.com/tvo">
<f:view>
	<ui:composition template="/layout/adminLayout.xhtml">
		<ui:define name="menu">
			<tvo:tvo-menu active="test"></tvo:tvo-menu>
		</ui:define>
		<ui:define name="msg"></ui:define>
		<ui:define name="title">
          ScreenPlay Edit
     </ui:define>
		<ui:define name="body">
			<h:form id="frmEditScreenPlay" enctype="multipart/form-data"
				prependId="false">
				<div class="main">
					<div class="main-container">
						<div class="main-content">
							<div style="height: 25px; margin-left: 0px">
								<h:messages id="msg" for="globalMessage" errorClass="error"
									infoClass="success" />
							</div>
							<h:inputHidden id="globalMessage"></h:inputHidden>
							<!-- upload area -->
							<div class="width100">
								<div class="width45 left">
									<div
										style="background: no-repeat center; height: auto; margin: 0 auto">
										<div class="width100 left">
											<p style="margin: 0 0 5px 0">
												<label class="bold">ScreenPlay Image</label>
											</p>
											<div class="rbt_img">
												<p:graphicImage id="image_edit"
													value="#{screenplayManagedBean.imageData != null ? screenplayManagedBean.imageData : '/resources/images/no-images.png'}"
													width="98" height="98" style="margin:-6px 7px;"
													cache="false" />
											</div>

											<div class="left"
												style="padding-left: 210px; width: 112px; height: 50px;">
												<p:fileUpload
													fileUploadListener="#{screenplayManagedBean.handleFileUpload}"
													auto="true" mode="advanced" label="Change Image"
													update="frmEditScreenPlay:image_edit" />
											</div>
										</div>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px" />
										<p style="margin: 0 0 5px 0">
											<label class=" bold">Required level</label>
											<h:selectOneMenu
												value="#{screenplayManagedBean.selectedLevel}">
												<f:selectItems value="#{screenplayManagedBean.levels}"
													var="level" itemLabel="#{level.id}" itemValue="#{level.id}" />
											</h:selectOneMenu>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px"></div>
										<p style="margin: 0 0 5px 0">
											<label class=" bold">Show category</label>
											<h:selectOneMenu
												value="#{screenplayManagedBean.selectedShowCategory}">
												<f:selectItems value="#{screenplayManagedBean.showCategory}"
													var="showCat" itemLabel="#{showCat.name}"
													itemValue="#{showCat.id}" />
											</h:selectOneMenu>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="screenplayName"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class=" bold">Screenplay Name</label>
											<h:inputText id="screenplayName" label="Screenplay Name"
												value="#{screenplayManagedBean.currentScreenplay.name}"
												required="true"
												requiredMessage="Screenplay Name is required"
												styleClass="text medium" maxlength="50">
												<f:validator validatorId="textInputValidator"></f:validator>
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="numberEpisode"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class=" bold">Number of episodes</label>
											<h:inputText id="numberEpisode" label="Number of Episode"
												value="#{screenplayManagedBean.currentScreenplay.episodesNumber}"
												required="true"
												requiredMessage="Number of episode is mandatory."
												converterMessage="Number of episode must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="estimateViewer"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class=" bold">Estimated viewer</label>
											<h:inputText id="estimateViewer" label="Estimate Viewer"
												value="#{screenplayManagedBean.currentScreenplay.estimatedViewer}"
												required="true"
												requiredMessage="Estimated Viewer is mandatory."
												converterMessage="Estimated Viewer must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="price"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class=" bold">Selling price after production</label>
											<h:inputText id="price" label="Price"
												value="#{screenplayManagedBean.currentScreenplay.sellingPriceAfterProduction}"
												required="true" requiredMessage="Price is mandatory."
												converterMessage="Price must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="xp"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class=" bold">XP</label>
											<h:inputText id="xp" label="Xp"
												value="#{screenplayManagedBean.currentScreenplay.xp}"
												required="true" requiredMessage="XP is mandatory."
												converterMessage="Xp must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="lovePoint"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class=" bold">Love point</label>
											<h:inputText id="lovePoint" label="Love point"
												value="#{screenplayManagedBean.currentScreenplay.lovePoint}"
												required="true" requiredMessage="Love point is mandatory"
												converterMessage="Love point must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="productionTime"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class=" bold">Production time</label>
											<h:inputText id="productionTime" label="Production time"
												value="#{screenplayManagedBean.currentScreenplay.productionTime}"
												required="true"
												requiredMessage="Production time is mandatory"
												converterMessage="Production time must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="moneyGold"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class=" bold">Money gold</label>
											<h:inputText id="moneyGold" label="Money gold"
												value="#{screenplayManagedBean.currentScreenplay.moneyGold}"
												required="true" requiredMessage="Money Gold is mandatory."
												converterMessage="Money gold  must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="moneyCoin"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Money coin</label>
											<h:inputText id="moneyCoin" label="Money Coin"
												value="#{screenplayManagedBean.currentScreenplay.moneyCoin}"
												required="true" requiredMessage="Money Coin is mandatory."
												converterMessage="Money coin  must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="reduceRate"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Reduce Rate</label>
											<h:inputText id="reduceRate" label="Reduce Rate"
												value="#{screenplayManagedBean.currentScreenplay.reduceRate}"
												required="true" requiredMessage="Reduce Rate is mandatory."
												converterMessage="Reduce Rate  must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="viewerDecrease"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Viewer Decrease</label>
											<h:inputText id="viewerDecrease" label="Viewer Decrease"
												value="#{screenplayManagedBean.currentScreenplay.viewerDecrease}"
												required="true"
												requiredMessage="Viewer Decrease is mandatory."
												converterMessage="Viewer Decrease  must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>

										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="duration"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class=" bold">Duration</label>
											<h:inputText id="duration" label="Duration"
												value="#{screenplayManagedBean.currentScreenplay.duration}"
												required="true" requiredMessage="Duration is mandatory."
												converterMessage="Duration  must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px" />
										<p style="margin: 0 0 5px 0">
											<label class="bold">Description</label>
											<h:inputTextarea
												value="#{screenplayManagedBean.currentScreenplay.description}"
												styleClass="text medium" />
										</p>
									</div>
								</div>
								<!-- Drop item -->
								<div class="width55 right">
									<div class="width100 right">
										<p:dataTable id="droppableItemPanel" paginator="true"
											rows="10"
											paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
											paginatorPosition="top" headerClass="order-table-header"
											rowClasses="order-table-odd-row,order-table-even-row"
											value="#{screenplayManagedBean.listDroppableItem}"
											var="partnerItem" width="100%">
											<f:facet name="header">  
									           Droppable Items
									          	 <p:commandLink oncomplete="dlgAddItem.show();"
													action="#{screenplayManagedBean.addDroppableItem}"
													styleClass="right" style="margin-right: 5px"
													immediate="true" update="frmAddItem">
													<img
														src="#{facesContext.externalContext.requestContextPath}/resources/images/ico_add.png"></img>
												</p:commandLink>
											</f:facet>
											<p:column>
												<f:facet name="header">
													Item Name
												</f:facet>
												<h:outputText value="#{partnerItem.item.name}"></h:outputText>
											</p:column>
											<p:column>
												<f:facet name="header">
													Dropped Rate
												</f:facet>
												<div style="height: 25px; margin-left: 0px;">
													<div style="height: 25px; margin-left: 0px; float: left;">
														<p:inputText id="droppedRate" label="Dropped Rate"
															value="#{partnerItem.droppableRate}" required="true"
															maxlength="4" requiredMessage="Dropped rate is required"
															converterMessage="Dropped rate must be a number"
															styleClass="ui-inputfield ui-inputtext ui-widget ui-state-default ui-corner-all"
															style="width: 40px">
															<f:validator validatorId="numberValidator" />
															<p:ajax event="blur" />
														</p:inputText>
														<h:outputText value="%"></h:outputText>
													</div>
													<div class="error-msg"
														style="height: 25px; padding: 3px 0px 0px">
														<h:message for="droppedRate"></h:message>
													</div>
												</div>
											</p:column>
											<p:column>
												<f:facet name="header">
													Action
												</f:facet>
												<h:commandLink
													action="#{screenplayManagedBean.removeDroppableItem(partnerItem)}"
													value="Delete" styleClass="global-text-link">
													<h:graphicImage
														url="#{facesContext.externalContext.requestContextPath}/resources/images/ico_add.png"></h:graphicImage>
												</h:commandLink>
											</p:column>
										</p:dataTable>
										<br />
										<p:dataTable id="requiredItemTable" paginator="true" rows="10"
											paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
											paginatorPosition="top" headerClass="order-table-header"
											rowClasses="order-table-odd-row,order-table-even-row"
											value="#{screenplayManagedBean.listScreenPlayItem}"
											var="requireItem" width="100%">
											<f:facet name="header">  
									           Required Items To Create Show
									          	 <p:commandLink
													oncomplete="dlgAddRequiredItem.show();"
													action="#{screenplayManagedBean.addScreenPlayItem}"
													styleClass="right" style="margin-right: 5px"
													immediate="true" update="frmAddScreenplayItem">
													<img
														src="#{facesContext.externalContext.requestContextPath}/resources/images/ico_add.png"></img>
												</p:commandLink>
											</f:facet>
											<p:column>
												<f:facet name="header">
													Item Name
												</f:facet>
												<h:outputText value="#{requireItem.tblItem.name}"></h:outputText>
											</p:column>
											<p:column>
												<f:facet name="header">
													Quantity
												</f:facet>
												<div style="height: 25px; margin-left: 0px;">
													<div style="height: 25px; margin-left: 0px; float: left;">
														<p:inputText id="quantity" label="Quantity"
															value="#{requireItem.quantity}" required="true"
															maxlength="4" requiredMessage="Quantity is required"
															converterMessage="Quantity must be a number"
															styleClass="ui-inputfield ui-inputtext ui-widget ui-state-default ui-corner-all"
															style="width: 40px">
															<f:validator validatorId="numberValidator" />
															<p:ajax event="blur" />
														</p:inputText>
													</div>
													<div>
														<div class="error-msg"
															style="height: 25px; padding: 3px 0px 0px">
															<h:message for="quantity"></h:message>
														</div>
													</div>
												</div>
											</p:column>
											<p:column>
												<f:facet name="header">
													Action
												</f:facet>
												<h:commandLink
													action="#{screenplayManagedBean.removeScreenplayItem(requireItem)}"
													value="Delete" styleClass="global-text-link">
													<h:graphicImage
														url="#{facesContext.externalContext.requestContextPath}/resources/images/ico_add.png"></h:graphicImage>
												</h:commandLink>
											</p:column>
										</p:dataTable>
									</div>
								</div>
							</div>
						</div>
						<div class="width100 left">
							<div class="button_bottom" style="margin-left: 5px">
								<h:commandLink action="#{screenplayManagedBean.update}"
									value="Update" styleClass="global-btn" />
								<h:commandButton action="#{screenplayManagedBean.cancel}"
									value="Cancel" immediate="true" styleClass="global-btn" />
							</div>
						</div>
					</div>
				</div>
			</h:form>
			<!--End  Form Edit -->
			<!-- add droppable item dialog -->
			<p:dialog header="Add Item" widgetVar="dlgAddItem" modal="true"
				resizable="false" appendToBody="true">
				<h:form id="frmAddItem" enctype="multipart/form-data">
					<p>
						<h:messages id="msgAddItem" infoClass="message success"
							errorClass="message error" />
					</p>
					<div style="width: 100%; margin-bottom: 20px">
						<!-- add grid for select item here -->
						<p:dataTable paginator="true" rows="10"
							paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} "
							paginatorPosition="top"
							value="#{screenplayManagedBean.dropItemDTOs}"
							styleClass="data_table" style="width: 100%; margin: 0"
							var="items" rowKey="#{items.id}" selectionMode="single"
							id="itemsTable">
							<p:ajax event="rowSelect"
								listener="#{screenplayManagedBean.onItemRowSelect}"
								oncomplete="dlgAddItem.hide();"
								update=":frmAddItem,droppableItemPanel" />
							<p:column style="padding: 5px;" headerText="Name">
								<b><h:outputText value="#{items.name}" class="left" /></b>
							</p:column>
							<p:column style="padding: 5px;" headerText="XP">
								<b><h:outputText value="#{items.xp}" class="left" /></b>
							</p:column>
							<p:column style="padding: 5px;" headerText="Required Level">
								<b><h:outputText value="#{items.tblLevel.id}" class="left" /></b>
							</p:column>
							<p:column style="padding: 5px;" headerText="Gold">
								<b><h:outputText value="#{items.moneyGold}" class="left" /></b>
							</p:column>
							<p:column style="padding: 5px;" headerText="Coin">
								<b><h:outputText value="#{items.moneyCoin}" class="left" /></b>
							</p:column>
						</p:dataTable>
					</div>
				</h:form>
			</p:dialog>
			<!-- end add droppable item dialog -->
			<!-- add screenplay item dialog -->
			<p:dialog header="Add Required Item To Create Show"
				widgetVar="dlgAddRequiredItem" modal="true" resizable="false"
				appendToBody="true">
				<h:form id="frmAddScreenplayItem" enctype="multipart/form-data">
					<p>
						<h:messages id="msgRequiredItem" infoClass="message success"
							errorClass="message error" />
					</p>
					<div style="width: 100%; margin-bottom: 20px">
						<!-- add grid for select item here -->
						<p:dataTable paginator="true" rows="10"
							paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
							paginatorPosition="top"
							value="#{screenplayManagedBean.requiredItemDTOs}"
							styleClass="data_table" style="width: 100%; margin: 0" var="si"
							rowKey="#{si.id}" selectionMode="single"
							id="screenplayItemsTable">
							<p:ajax event="rowSelect"
								listener="#{screenplayManagedBean.onRequiredItemRowSelect}"
								oncomplete="dlgAddRequiredItem.hide();"
								update="frmAddScreenplayItem,requiredItemTable" />
							<p:column style="padding: 5px;" headerText="Name">
								<b><h:outputText value="#{si.name}" class="left" /></b>
							</p:column>
							<p:column style="padding: 5px;" headerText="XP">
								<b><h:outputText value="#{si.xp}" class="left" /></b>
							</p:column>
							<p:column style="padding: 5px;" headerText="Required Level">
								<b><h:outputText value="#{si.tblLevel.id}" class="left" /></b>
							</p:column>
							<p:column style="padding: 5px;" headerText="Gold">
								<b><h:outputText value="#{si.moneyGold}" class="left" /></b>
							</p:column>
							<p:column style="padding: 5px;" headerText="Coin">
								<b><h:outputText value="#{si.moneyCoin}" class="left" /></b>
							</p:column>
						</p:dataTable>
					</div>
				</h:form>
			</p:dialog>
			<!-- end add screenplay item dialog -->
		</ui:define>
	</ui:composition>
</f:view>
</html>