<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.prime.com.tr/ui"
	xmlns:tvo="http://tinhvan.com/tvo">
<f:view>
	<ui:composition template="/layout/adminLayout.xhtml">
		<ui:define name="menu">
			<tvo:tvo-menu active="test"></tvo:tvo-menu>
		</ui:define>
		<ui:define name="msg"></ui:define>
		<ui:define name="title">
		          Movie Create
		     </ui:define>
		<ui:define name="body">
			<h:form id="frmCreateMovie" enctype="multipart/form-data"
				prependId="false">
				<div class="main">
					<div class="main-container">
						<div class="main-content">
							<div style="height: 25px; margin-left: 0px">
								<h:messages id="msg" for="globalMessage" errorClass="error"
									infoClass="success" />
							</div>
							<h:inputHidden id="globalMessage"></h:inputHidden>
							<!-- input area -->
							<div class="width100 left">
								<div class="width45 left">
									<div
										style="background: no-repeat center; height: auto; margin: 0 auto">
										<div class="width100 left">
											<p style="margin: 0 0 5px 0">
												<label class="bold">Movie Image</label>
											</p>
											<!-- upload area -->
											<div class="rbt_img">
												<p:graphicImage id="image_create"
													value="#{movieManagedBean.imageData != null ? movieManagedBean.imageData : '/resources/images/no-images.png'}"
													width="98" height="98" style="margin:-6px 7px;"
													cache="false" />
											</div>
											<div
												style="background: no-repeat center; width: 112px; height: 50px; padding-left: 210px;">
												<p:fileUpload
													fileUploadListener="#{movieManagedBean.handleFileUpload}"
													label="Change Image" auto="true" mode="advanced"
													update="frmCreateMovie:image_create,msg" />
											</div>
											<!-- end upload area -->
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Movie Category</label>
											<h:selectOneMenu
												value="#{movieManagedBean.selectedCategoryId}">
												<f:selectItems value="#{movieManagedBean.lsShowCategory}"
													var="category" itemLabel="#{category.name}"
													itemValue="#{category.id}" />
											</h:selectOneMenu>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px"></div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Require Level</label>
											<h:selectOneMenu value="#{movieManagedBean.selectedLevelId}">
												<f:selectItems value="#{movieManagedBean.lsLevelDTO}"
													var="level" itemLabel="#{level.id}" itemValue="#{level.id}" />
											</h:selectOneMenu>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="movieName"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Movie Name</label>
											<h:inputText id="movieName" label="Movie Name"
												value="#{movieManagedBean.showDTO.title}" required="true"
												requiredMessage="Movie Name is required"
												styleClass="text medium" maxlength="50">
												<f:validator validatorId="textInputValidator"></f:validator>
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="xp"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Xp</label>
											<h:inputText id="xp" label="Xp"
												value="#{movieManagedBean.showDTO.xp}" required="true"
												requiredMessage="XP is required"
												converterMessage="Xp must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="estimatedViewer"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Estimated Viewer</label>
											<h:inputText id="estimatedViewer" label="Estimated Viewer"
												value="#{movieManagedBean.showDTO.estimatedViewer}"
												required="true"
												requiredMessage="Estimated Viewer is required"
												converterMessage="Estimated Viewer must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="viewerDecrease"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Viewer decrease</label>
											<h:inputText id="viewerDecrease" label="Viewer decrease"
												value="#{movieManagedBean.showDTO.xpViewerDecrease}"
												required="true"
												requiredMessage="Viewer decrease is required"
												converterMessage="Viewer decrease must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="moneyGold"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Money gold</label>
											<h:inputText id="moneyGold" label="Money gold"
												value="#{movieManagedBean.showDTO.moneyGold}"
												required="true" requiredMessage="Money gold  is required"
												converterMessage="Money gold must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="espisode"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Espisode</label>
											<h:inputText id="espisode" label="Espisode"
												value="#{movieManagedBean.showDTO.numberOfEpisodes}"
												required="true" requiredMessage="Espisode is required"
												converterMessage="Espisode must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="moneyCoin"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Money Coin</label>
											<h:inputText id="moneyCoin" label="Money Coin"
												value="#{movieManagedBean.showDTO.moneyCoin}"
												required="true" requiredMessage="Money Coin is required"
												converterMessage="Money coin must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="reduceRate"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Reduce rate</label>
											<h:inputText id="reduceRate" label="Reduce rate"
												value="#{movieManagedBean.showDTO.reduceRate}"
												required="true" requiredMessage="Reduce rate is required"
												converterMessage="Reduce rate  must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="lovePoint"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Love Point</label>
											<h:inputText id="lovePoint" label="Love Point"
												value="#{movieManagedBean.showDTO.lovePoint}"
												required="true" requiredMessage="Love Point is required"
												converterMessage="Love Point  must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px">
											<h:message for="duration"></h:message>
										</div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Duration</label>
											<h:inputText id="duration" label="Duration"
												value="#{movieManagedBean.showDTO.duration}" required="true"
												requiredMessage="Duration is required"
												converterMessage="Duration  must be number"
												styleClass="text medium" maxlength="9">
												<f:validator validatorId="numberValidator" />
											</h:inputText>
										</p>
										<div class="error-msg"
											style="margin-left: 214px; height: 18px"></div>
										<p style="margin: 0 0 5px 0">
											<label class="bold">Description</label>
											<h:inputTextarea id="description" label="Description"
												value="#{movieManagedBean.showDTO.description}"
												styleClass="text medium" maxlength="1024" />
										</p>
									</div>
								</div>
								<!-- end input area -->
								<!-- DATAGRID AREA -->
								<div class="width55 right">
									<div class="width100 right">
										<p:dataTable id="droppableItemPanel" paginator="true"
											rows="10"
											paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
											paginatorPosition="top" headerClass="order-table-header"
											rowClasses="order-table-odd-row,order-table-even-row"
											value="#{movieManagedBean.lsDropableItemDTOs}"
											var="partnerItem" width="100%">
											<f:facet name="header">  
										           Droppable Items
										          	 <p:commandLink immediate="true"
													oncomplete="dlgAddItem.show();"
													action="#{movieManagedBean.addDroppableItem}"
													styleClass="right" style="margin-right: 5px"
													update="frmAddItem">
													<img
														src="#{facesContext.externalContext.requestContextPath}/resources/images/ico_add.png"></img>
												</p:commandLink>
											</f:facet>
											<p:column>
												<f:facet name="header">
														Item Name
													</f:facet>
												<h:outputText value="#{partnerItem.item.name}"></h:outputText>
											</p:column>
											<p:column>
												<f:facet name="header">
														Dropped Rate
													</f:facet>
												<div style="height: 25px; margin-left: 0px;">
													<div style="height: 25px; margin-left: 0px; float: left;">
														<p:inputText id="droppedRate" label="Dropped rate"
															value="#{partnerItem.droppedRate}" required="true"
															maxlength="5" requiredMessage="Dropped rate is required"
															converterMessage="Dropped rate must be a number"
															styleClass="ui-inputfield ui-inputtext ui-widget ui-state-default ui-corner-all"
															style="width: 40px">
															<f:validator validatorId="numberValidator" />
															<p:ajax event="blur" />
														</p:inputText>
														<h:outputText value="%"></h:outputText>
													</div>
													<div class="error-msg"
														style="height: 25px; padding: 3px 0px 0px">
														<h:message for="droppedRate"></h:message>
													</div>
												</div>
											</p:column>
											<p:column>
												<f:facet name="header">
														Action
													</f:facet>

											</p:column>
										</p:dataTable>
									</div>
									<!-- END DATA GRID AREA -->
								</div>
								<div class="width100 left">
									<div style="margin-top: 7px; float: left;" class="pbutton">
										<p>
											<h:commandButton action="#{movieManagedBean.createMovie}"
												value="Create" styleClass="global-btn" />
											<h:commandButton action="#{movieManagedBean.cancel}"
												value="Cancel" immediate="true" styleClass="global-btn" />
										</p>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</h:form>
			<!-- end add droppable item dialog -->
			<!-- add droppable item dialog -->
			<p:dialog header="Add Item" resizable="false" widgetVar="dlgAddItem"
				modal="true" appendToBody="true">
				<h:form id="frmAddItem" enctype="multipart/form-data">
					<div class="left" style="width: 95%">
						<p:messages showDetail="false" autoUpdate="true" globalOnly="true" />
					</div>
					<div style="width: 100%">
						<!-- add grid for select item here -->
						<p:dataTable value="#{movieManagedBean.itemDTOs}" paginator="true"
							rows="10"
							paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
							paginatorPosition="top" headerClass="table-header"
							styleClass="table-boder" var="items" rowKey="#{items.id}"
							selectionMode="single" id="itemsTable">
							<p:ajax event="rowSelect"
								listener="#{movieManagedBean.onItemRowSelect}"
								oncomplete="dlgAddItem.hide();"
								update=":frmAddItem,droppableItemPanel" />
							<p:column style="padding: 5px;" headerText="Name">
								<b><h:outputText value="#{items.name}" class="left" /></b>
							</p:column>
							<p:column style="padding: 5px;" headerText="XP">
								<b><h:outputText value="#{items.xp}" class="left" /></b>
							</p:column>
							<p:column style="padding: 5px;" headerText="Required Level">
								<b><h:outputText value="#{items.tblLevel.id}" class="left" /></b>
							</p:column>
							<p:column style="padding: 5px;" headerText="Gold">
								<b><h:outputText value="#{items.moneyGold}" class="left" /></b>
							</p:column>
							<p:column style="padding: 5px;" headerText="Coin">
								<b><h:outputText value="#{items.moneyCoin}" class="left" /></b>
							</p:column>
						</p:dataTable>
					</div>
					<br></br>
				</h:form>
			</p:dialog>
			<!-- end add droppable item dialog -->
		</ui:define>
	</ui:composition>
</f:view>
</html>